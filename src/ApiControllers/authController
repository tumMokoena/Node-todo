var express = require("express")
const jsonwebtoken = require("jsonwebtoken");
var router = express.Router()

const JWT_SECRET = process.env.jwtSecret;

router.post("/login", (req, res) => {
  const { username, password } = req.body;
  console.log(`${username} is trying to login ..`);

  if (username === "admin" && password === "admin") {
    return res.json({
      token: jsonwebtoken.sign({ user: "admin" }, JWT_SECRET),
    });
  }

  return res
    .status(401)
    .json({ message: "The username and password your provided are invalid" });
});

module.exports = router;